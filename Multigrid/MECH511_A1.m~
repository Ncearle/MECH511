%% MECH 511 - Multigrid Assignment

clear; clc; close all;

xmin = 0; xmax = 1;
imax = 100;
dx = (xmax - xmin) / imax;

k = imax/2:imax;
sig = @(w) max(abs(1 - w*(1 - cos(k*pi*dx))));
sig2 = @(w1, w2) (1 - w1*(1 - cos(k*pi*dx))) .* (1 - w2*(1 - cos(k*pi*dx)));

sig2 = @(w1, w2) (1 - w1*(1 - cos(k*pi*dx))) .* (1 - w1/(3*w1-1)*(1 - cos(k*pi*dx)));

% sig3 = @(w1, w2) (1 - w1*(1 - cos(imax/2*pi*dx))) .* (1 - w2*(1 - cos(imax/2*pi*dx)))...
%     - (1 - w1*(1 - cos(imax*pi*dx))) .* (1 - w2*(1 - cos(imax*pi*dx)));

w1 = 0.5:0.1:1;
w2 = w1./(3*w1-1);


for i = 1:6
    plot(k, sig2(w1(i), w2(i)));
    hold on
    leg{i} = sprintf('w1=%0.4f, w2=%0.4f', w1(i), w2(i));
end
legend(leg);


% y = fminsearch(sig3, w);
% 
% x = fminsearch(sig, 0.6);
% 
% plot(k, sig2(y));
% hold on
% plot(k, sig2(0.6, 0.8, k));
% plot(k, sig2(0.6, 1, k));
% plot(k, sig2(0.55, 0.85, k));

% figure(1);
% for w = 1:10
%     plot(k, sig(w/10));
%     hold on;
%     q = w/10;
%     leg{w} = sprintf('w = %0.1f',q);
% end
% legend(leg);

